###Pure
Class org::legend::Person
{
  name: String[0..1];
}

###Mapping
Mapping org::legend::PersonMapping
(
)

###Service
Service org::legend::PersonService
{
  pattern: 'person';
  documentation: 'Person test service';
  autoActivateUpdates: true;
  execution: Single
  {
    query: src: org::legend::Person[1]|$src.name;
    mapping: org::legend::PersonMapping;
    runtime:
    #{
      mappings:
      [
        org::legend::PersonMapping
      ];
    }#;
  }
  testSuites:
  [

  ]
  test: Single
  {
    data: 'test';
    asserts:
    [
    ];
  }
}

//TODO - leaving this commented for now as there will be many changes to Mastery grammar in the coming weeks, comment out when grammar is stable to prevent breaking changes to studio build
// ###Mastery
// MasterRecordDefinition org::legend::PersonMasterRecord
// {
//   modelClass: org::legend::Person;
//   identityResolution:
//   {
//     modelClass: org::legend::Person;
//     resolutionQueries:
//       [
//         {
//           queries: [ {input: org::legend::Person[1]|org::legend::Person.all()->filter(person|$person.name == $input.name)}
//                    ];
//           keyType: Optional;
//           precedence: 1;
//         }
//       ]
//   }
//   recordSources:
//   [
//     {
//       createBlockedException: false;
//       createPermitted: true;
//       description: 'Test Source';
//       id: 'test-source-id';
//       partitions:
//       [
//         {
//           id: 'test-partition-1';
//           tags: [];
//         }
//       ]
//       parseService: org::legend::PersonService;
//       sequentialData: true;
//       stagedLoad: false;
//       status: Development;
//       transformService: org::legend::PersonService;
//     }
//   ]
// }
